<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Project 1 : HW 4 for Data Visualization - d3 visualization">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">
    <script src="http://code.jquery.com/jquery-1.11.2.js"></script>
    <script type"text/javascript" src="javascripts/main.js"></script>
    <script type="text/javascript" src="http://d3js.org/d3.v2.min.js?2.9.5"></script>
    <title>Project 1</title>
    <style>
      body {
        font: 10px sans-serif;
      }
      
      .axis path,
      .axis line {
        fill: none;
        stroke: #000;
        shape-rendering: crispEdges;
      }
      
</style>
  </head>
  <body>
    <div id="fb-root"></div>
    <script>(function(d, s, id) {
      var js, fjs = d.getElementsByTagName(s)[0];
      if (d.getElementById(id)) return;
      js = d.createElement(s); js.id = id;
      js.src = "//connect.facebook.net/pt_BR/sdk.js#xfbml=1&version=v2.3";
      fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>
    <!--Header-->
      <a href="index.html">
     <div id="myheader" style="margin-left:0px; width: 1100px">
        <h1>Data Visualization Project</h1>
        <h2>IE590</h2>
      </div>
  </a>
  <div id="myBody" style="margin-left:0px; width:1100px ">
      <!--Body-->
      <!--Data base-->
      <div id="visualizations" style="margin-left:0px; width:1100px">
         <h2><a name="visualization2">Anual Colombian Exports By Type of goods  </a></h2>
          <h3 style="text-align:center;"><a name="description" >The subsequent visualisation shows the total Colombian exports divided by the type of the goods exported </a></h3>
          <p>Conclusions</p>
      </div>
      <div  id="visualizations" style="margin-left:0px; width:1100px">
    
        <!--Visualization-->
        <div>
         
          <div id="graph"></div>
            <script type="text/javascript">
            var format=d3.time.format("%Y");
          var width=1000;
          var height=600;
          var padding=50;
          //var parseDate = d3.time.format("%Y").parse;
         var tooltip = d3.select("body")
              .append("div")
              .attr("class", "remove")
              .style("position", "absolute")
              .style("z-index", "20")
              .style("visibility", "hidden")
              .style("top", "30px")
              .style("left", "55px");
              
          var xScale = d3.time.scale()
             // .domain([2006,2014])
              .range([padding, width-padding]);
          
          var yScale = d3.scale.linear()
             // .domain([0,45000000])
              .range([height-padding, padding]);
          
          var color = d3.scale.category20();
          
          var xAxis = d3.svg.axis()
              .scale(xScale)
              .orient("bottom");
          
          var yAxis = d3.svg.axis()
              .scale(yScale)
              .orient("left");
          
         var stack=d3.layout.stack()
              .offset("zero")
              .values(function(d){return d.values;})
              .x(function(d){return d.anio;})
              .y(function(d){return d.expo;});
          
          var nest = d3.nest()
              .key(function(d) { return d.area; });
          
          var area=d3.svg.area()
              .interpolate("cardinal")
              .x(function(d){return xScale(d.anio);})
              .y0(function(d) { return yScale(d.y0); })
              .y1(function(d) { return yScale(d.y0 + d.y); });
              
          var svg=d3.select("#graph")
              .append("svg")
              .attr("width",width)
              .attr("height",height)
              .append("g")
              .attr("transform","translate("+(padding-20)+","+padding+")");
          
          d3.csv("ExportsByCategory.csv", function(data) {
            
            console.log(nest.entries(data));
            data.forEach(function(d) {
              d.anio = format.parse(d.anio.toString());
              d.expo = +d.expo;
            }); 
            
            var layers = stack(nest.entries(data));
            //console.log(d3.extent(function(d){return d.anio;}));
            xScale.domain(d3.extent(data, function(d) { console.log(d.anio);return d.anio; }));
            yScale.domain([0,d3.max(function(d){return d.y0+d.y})]);
                svg.selectAll(".layer")
                .data(layers)
                .enter()
                .append("path")
                .attr("class","layer")
                .attr("d",function(d){console.log(area(d.values));return area(d.values);})
                .attr("transform",function(d){return"translate("+(padding-20)+","+(-padding)+")";})
                .style("fill",function(d,i){return color(i);});
                
                svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(-20,500 )")
                .call(xAxis);
                
                svg.append("g")
                .attr("class", "y axis")
                .attr("transform", "translate(30,-50 )")
                .call(yAxis);
                
                svg.selectAll(".layer")
                .attr("opacity", 1)
                .on("mouseover", function(d, i) {
                  d3.select(this)
                  .classed("hover", true)
                  tooltip.html( "<p>" + d.area + "<br>" + d.expo + "</p>" ).style("visibility", "visible");
                  console.log(d.expo);
                })
                .on("mouseout", function(d, i) {
                  d3.select(this)
                  .classed("hover", false)
                  tooltip.html( "<p>" + d.area + "<br>" + d.expo + "</p>" ).style("visibility", "hidden");
                 console.log(d.expo);
                })

          });
  </script>
  
<<div class="fb-comments" data-href="http://datavisualizationam.github.io/Project_1/index3.html" data-width="1000" data-numposts="5" data-colorscheme="light" s></div>
  
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'colombianexports'; // Required - Replace '<example>' with your forum shortname
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </body>
</html>
